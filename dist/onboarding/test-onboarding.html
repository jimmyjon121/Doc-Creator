<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Onboarding System Test</title>
    <link rel="stylesheet" href="onboarding-styles.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f7fa;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #2C3E50;
            margin-top: 0;
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .test-button {
            background: #4ECDC4;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s;
        }
        .test-button:hover {
            background: #3db8af;
            transform: translateY(-2px);
        }
        .test-button.secondary {
            background: #ECF0F1;
            color: #2C3E50;
        }
        .test-button.secondary:hover {
            background: #d5dbdb;
        }
        .status {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            font-size: 14px;
        }
        .status.success {
            background: #E8F5E9;
            color: #2E7D32;
        }
        .status.info {
            background: #E3F2FD;
            color: #1565C0;
        }
        .mock-dashboard {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        .mock-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        .priority-zones {
            display: flex;
            gap: 15px;
        }
        .zone {
            flex: 1;
            padding: 20px;
            border-radius: 8px;
            color: white;
            text-align: center;
            font-weight: 600;
        }
        .red-zone { background: #FF6B6B; }
        .yellow-zone { background: #FFD93D; color: #333; }
        .green-zone { background: #6BCF7F; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üéì CareConnect Onboarding System Test</h1>
        
        <div class="test-section">
            <h2>Onboarding Flow Tests</h2>
            <button class="test-button" onclick="testFullFlow()">Start Full Onboarding</button>
            <button class="test-button" onclick="testVideoOnly()">Test Video Only</button>
            <button class="test-button" onclick="testTourOnly()">Test Tour Only</button>
            <button class="test-button" onclick="testPracticeOnly()">Test Practice Only</button>
            <div id="flow-status" class="status" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h2>State Management Tests</h2>
            <button class="test-button secondary" onclick="checkState()">Check Current State</button>
            <button class="test-button secondary" onclick="resetState()">Reset State</button>
            <button class="test-button secondary" onclick="simulateProgress()">Simulate 50% Progress</button>
            <div id="state-status" class="status" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h2>Mock Dashboard (for Tour Testing)</h2>
            <div class="priority-zones">
                <div class="zone red-zone">Red Zone<br>3 items</div>
                <div class="zone yellow-zone">Yellow Zone<br>5 items</div>
                <div class="zone green-zone">Green Zone<br>12 items</div>
            </div>
            <div class="mock-dashboard">
                <div class="mock-card">
                    <h3>Client A</h3>
                    <p>Day 15 ‚Ä¢ 60% Complete</p>
                    <button class="test-button timeline-button">Timeline</button>
                </div>
                <div class="mock-card">
                    <h3>Client B</h3>
                    <p>Day 28 ‚Ä¢ 85% Complete</p>
                    <button class="test-button bulk-update-button">Bulk Update</button>
                </div>
                <div class="mock-card">
                    <h3>Client C</h3>
                    <p>Day 2 ‚Ä¢ 20% Complete</p>
                    <button class="test-button discharge-checklist-button">Checklist</button>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2>Integration Tests</h2>
            <button class="test-button secondary" onclick="testAutoDetection()">Test Auto-Detection</button>
            <button class="test-button secondary" onclick="testReplay()">Test Replay</button>
            <button class="test-button secondary" onclick="testKeyboardShortcut()">Test Keyboard (Ctrl+Shift+H)</button>
            <div id="integration-status" class="status" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h2>System Information</h2>
            <div id="system-info" class="status info"></div>
        </div>
    </div>

    <!-- Load onboarding scripts -->
    <script src="onboarding-content.js"></script>
    <script src="onboarding-manager.js"></script>
    <script src="onboarding-video.js"></script>
    <script src="onboarding-tour.js"></script>
    <script src="onboarding-practice.js"></script>

    <script>
        // Initialize onboarding manager
        const manager = new OnboardingManager();

        // Test functions
        async function testFullFlow() {
            showStatus('flow-status', 'Starting full onboarding flow...', 'info');
            try {
                await manager.start();
                showStatus('flow-status', '‚úÖ Full onboarding flow completed!', 'success');
            } catch (error) {
                showStatus('flow-status', '‚ùå Error: ' + error.message, 'error');
            }
        }

        async function testVideoOnly() {
            showStatus('flow-status', 'Testing video component...', 'info');
            try {
                const video = new OnboardingVideo(manager);
                await video.play();
                showStatus('flow-status', '‚úÖ Video test completed!', 'success');
            } catch (error) {
                showStatus('flow-status', '‚ùå Error: ' + error.message, 'error');
            }
        }

        async function testTourOnly() {
            showStatus('flow-status', 'Testing tour component...', 'info');
            try {
                const tour = new OnboardingTour(manager);
                await tour.start();
                showStatus('flow-status', '‚úÖ Tour test completed!', 'success');
            } catch (error) {
                showStatus('flow-status', '‚ùå Error: ' + error.message, 'error');
            }
        }

        async function testPracticeOnly() {
            showStatus('flow-status', 'Testing practice mode...', 'info');
            try {
                const practice = new OnboardingPractice(manager);
                window.onboardingPractice = practice;
                await practice.start();
                showStatus('flow-status', '‚úÖ Practice test completed!', 'success');
            } catch (error) {
                showStatus('flow-status', '‚ùå Error: ' + error.message, 'error');
            }
        }

        function checkState() {
            const state = manager.state;
            const info = `
                <strong>Current State:</strong><br>
                Started: ${state.started}<br>
                Completed: ${state.completed}<br>
                Skipped: ${state.skipped}<br>
                Video Watched: ${state.videoWatched}<br>
                Tour Completed: ${state.tourCompleted}<br>
                Practice Completed: ${state.practiceCompleted}<br>
                Progress: ${manager.getProgress()}%<br>
                Is New User: ${manager.isNewUser()}
            `;
            showStatus('state-status', info, 'info');
        }

        function resetState() {
            manager.reset();
            showStatus('state-status', '‚úÖ State reset successfully!', 'success');
            setTimeout(checkState, 100);
        }

        function simulateProgress() {
            manager.state.started = true;
            manager.state.videoWatched = true;
            manager.state.tourCompleted = false;
            manager.state.practiceCompleted = false;
            manager.saveState();
            showStatus('state-status', '‚úÖ Simulated 50% progress', 'success');
            setTimeout(checkState, 100);
        }

        function testAutoDetection() {
            const shouldLaunch = manager.shouldAutoLaunch();
            showStatus('integration-status', 
                `Auto-detection result: ${shouldLaunch ? '‚úÖ Would launch' : '‚ùå Would not launch'}`, 
                shouldLaunch ? 'success' : 'info'
            );
        }

        function testReplay() {
            showStatus('integration-status', 'Starting replay...', 'info');
            manager.replay();
        }

        function testKeyboardShortcut() {
            showStatus('integration-status', 'Press Ctrl+Shift+H (or Cmd+Shift+H) to test keyboard shortcut', 'info');
            
            // Add temporary listener
            const handler = (e) => {
                if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'H') {
                    e.preventDefault();
                    showStatus('integration-status', '‚úÖ Keyboard shortcut works!', 'success');
                    manager.replay();
                    document.removeEventListener('keydown', handler);
                }
            };
            document.addEventListener('keydown', handler);
        }

        function showStatus(elementId, message, type) {
            const element = document.getElementById(elementId);
            element.innerHTML = message;
            element.className = 'status ' + type;
            element.style.display = 'block';
        }

        // Display system info on load
        window.addEventListener('load', () => {
            const info = `
                <strong>Onboarding System Loaded</strong><br>
                Manager: ${typeof window.onboardingManager !== 'undefined' ? '‚úÖ' : '‚ùå'}<br>
                Content: ${typeof window.OnboardingContent !== 'undefined' ? '‚úÖ' : '‚ùå'}<br>
                Video: ${typeof window.OnboardingVideo !== 'undefined' ? '‚úÖ' : '‚ùå'}<br>
                Tour: ${typeof window.OnboardingTour !== 'undefined' ? '‚úÖ' : '‚ùå'}<br>
                Practice: ${typeof window.OnboardingPractice !== 'undefined' ? '‚úÖ' : '‚ùå'}<br>
                Current State: ${manager.isNewUser() ? 'New User' : 'Returning User'}<br>
                Progress: ${manager.getProgress()}%
            `;
            showStatus('system-info', info, 'info');
        });
    </script>
</body>
</html>

