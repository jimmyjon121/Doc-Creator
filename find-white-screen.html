<!DOCTYPE html>
<html>
<head>
    <title>Find White Screen Culprit</title>
    <style>
        body { background: #000; color: #0f0; font-family: monospace; padding: 20px; font-size: 12px; }
        .log { margin: 5px 0; }
        button { background: #0f0; color: #000; padding: 10px 20px; margin: 10px 0; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>
    <h1>üîç White Screen Detective</h1>
    <button onclick="openAndDiagnose()">Open Main App & Auto-Diagnose</button>
    <div id="output"></div>
    
    <script>
        function openAndDiagnose() {
            const win = window.open('AppsCode-DeluxeCMS.html?debug=' + Date.now(), '_blank');
            
            setTimeout(() => {
                if (win && !win.closed) {
                    try {
                        const doc = win.document;
                        const body = doc.body;
                        
                        log('üîç Checking main app window...');
                        
                        // Check all elements for what's covering
                        const allElements = doc.querySelectorAll('*');
                        const covering = [];
                        
                        allElements.forEach(el => {
                            const style = win.getComputedStyle(el);
                            const rect = el.getBoundingClientRect();
                            
                            // Check if element is full-screen and on top
                            if (rect.width > win.innerWidth * 0.9 && 
                                rect.height > win.innerHeight * 0.9 &&
                                style.position === 'fixed' || 
                                (style.backgroundColor && style.backgroundColor !== 'rgba(0, 0, 0, 0)')) {
                                
                                covering.push({
                                    element: el.tagName,
                                    id: el.id,
                                    class: el.className,
                                    zIndex: style.zIndex,
                                    position: style.position,
                                    display: style.display,
                                    background: style.backgroundColor,
                                    width: rect.width,
                                    height: rect.height
                                });
                            }
                        });
                        
                        log('Found ' + covering.length + ' potentially covering elements:');
                        covering.forEach(el => {
                            log(JSON.stringify(el, null, 2));
                        });
                        
                        // Check specific elements
                        const checks = {
                            body: doc.body,
                            loginScreen: doc.getElementById('loginScreen'),
                            mainApp: doc.getElementById('mainApp'),
                            dashboardTab: doc.getElementById('dashboardTab')
                        };
                        
                        log('\nüìã Element Status:');
                        Object.entries(checks).forEach(([name, el]) => {
                            if (el) {
                                const style = win.getComputedStyle(el);
                                log(`${name}: display=${style.display}, visibility=${style.visibility}, opacity=${style.opacity}, zIndex=${style.zIndex}`);
                            } else {
                                log(`${name}: NOT FOUND`);
                            }
                        });
                        
                    } catch (e) {
                        log('‚ùå Error: ' + e.message);
                    }
                }
            }, 3000);
        }
        
        function log(msg) {
            const div = document.createElement('div');
            div.className = 'log';
            div.textContent = msg;
            document.getElementById('output').appendChild(div);
        }
    </script>
</body>
</html>

